{% extends "base.html" %}

{% block title %}Payment Successful - Ytili{% endblock %}

{% block content %}
<div class="container mobile-container py-5">
    <div class="row justify-content-center">
        <div class="col-md-6">
            <!-- Success Animation -->
            <div class="text-center mb-4">
                <div class="success-animation">
                    <i class="fas fa-check-circle fa-5x text-success mb-3 animate-bounce"></i>
                </div>
                <h2 class="fw-bold text-success mb-2">Payment Successful!</h2>
                <p class="text-muted">Thank you for your generous donation</p>
            </div>

            <!-- Success Card -->
            <div class="card shadow mobile-spacing mb-4">
                <div class="card-body mobile-p-3 text-center">
                    <div class="success-message mb-4">
                        <h4 class="text-primary mb-3">
                            <i class="fas fa-heart text-danger"></i> 
                            Your donation is making a difference!
                        </h4>
                        <p class="lead">
                            Your contribution will help provide essential medical supplies to patients in need.
                        </p>
                    </div>

                    <!-- Donation Impact -->
                    <div class="impact-section mb-4">
                        <div class="row text-center">
                            <div class="col-4">
                                <div class="impact-item">
                                    <i class="fas fa-pills fa-2x text-primary mb-2"></i>
                                    <div class="fw-bold">Medications</div>
                                    <small class="text-muted">Provided</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="impact-item">
                                    <i class="fas fa-hospital fa-2x text-success mb-2"></i>
                                    <div class="fw-bold">Hospitals</div>
                                    <small class="text-muted">Supported</small>
                                </div>
                            </div>
                            <div class="col-4">
                                <div class="impact-item">
                                    <i class="fas fa-users fa-2x text-warning mb-2"></i>
                                    <div class="fw-bold">Lives</div>
                                    <small class="text-muted">Helped</small>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Points Earned -->
                    <div class="points-earned mb-4">
                        <div class="alert alert-info">
                            <div class="d-flex align-items-center justify-content-center gap-2">
                                <i class="fas fa-star text-warning"></i>
                                <strong>You earned 100 Ytili Points!</strong>
                            </div>
                            <small class="d-block mt-1">
                                Use points for priority healthcare support when you need it
                            </small>
                        </div>
                    </div>

                    <!-- Next Steps -->
                    <div class="next-steps">
                        <h6 class="fw-bold mb-3">What happens next?</h6>
                        <div class="timeline">
                            <div class="timeline-item">
                                <div class="timeline-icon">
                                    <i class="fas fa-check text-success"></i>
                                </div>
                                <div class="timeline-content">
                                    <strong>Payment Confirmed</strong><br>
                                    <small class="text-muted">Your donation has been received</small>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-icon">
                                    <i class="fas fa-truck text-primary"></i>
                                </div>
                                <div class="timeline-content">
                                    <strong>Processing</strong><br>
                                    <small class="text-muted">We're matching your donation with hospitals</small>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-icon">
                                    <i class="fas fa-hospital text-warning"></i>
                                </div>
                                <div class="timeline-content">
                                    <strong>Delivery</strong><br>
                                    <small class="text-muted">Supplies will be delivered to hospitals</small>
                                </div>
                            </div>
                            <div class="timeline-item">
                                <div class="timeline-icon">
                                    <i class="fas fa-bell text-info"></i>
                                </div>
                                <div class="timeline-content">
                                    <strong>Updates</strong><br>
                                    <small class="text-muted">You'll receive progress notifications</small>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Action Buttons -->
            <div class="d-grid gap-2 mb-4">
                <a href="{{ url_for('transparency.dashboard') }}" class="btn btn-primary btn-lg">
                    <i class="fas fa-chart-line"></i> Track Your Donation
                </a>
                <a href="{{ url_for('donations.index') }}" class="btn btn-outline-primary">
                    <i class="fas fa-heart"></i> Make Another Donation
                </a>
            </div>

            <!-- Share Section -->
            <div class="card mobile-spacing">
                <div class="card-body mobile-p-3 text-center">
                    <h6 class="fw-bold mb-3">
                        <i class="fas fa-share-alt"></i> Spread the Word
                    </h6>
                    <p class="mobile-text-sm text-muted mb-3">
                        Help us reach more people who want to make a difference
                    </p>
                    
                    <div class="d-flex justify-content-center gap-2">
                        <button class="btn btn-outline-primary btn-sm" onclick="shareOnFacebook()">
                            <i class="fab fa-facebook-f"></i> Facebook
                        </button>
                        <button class="btn btn-outline-info btn-sm" onclick="shareOnTwitter()">
                            <i class="fab fa-twitter"></i> Twitter
                        </button>
                        <button class="btn btn-outline-success btn-sm" onclick="shareOnWhatsApp()">
                            <i class="fab fa-whatsapp"></i> WhatsApp
                        </button>
                        <button class="btn btn-outline-secondary btn-sm" onclick="copyLink()">
                            <i class="fas fa-link"></i> Copy Link
                        </button>
                    </div>
                </div>
            </div>

            <!-- Support Section -->
            <div class="text-center mt-4">
                <p class="mobile-text-sm text-muted">
                    Questions about your donation? 
                    <a href="#" class="text-decoration-none">Contact Support</a>
                </p>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_css %}
<style>
.animate-bounce {
    animation: bounce 2s infinite;
}

@keyframes bounce {
    0%, 20%, 50%, 80%, 100% {
        transform: translateY(0);
    }
    40% {
        transform: translateY(-10px);
    }
    60% {
        transform: translateY(-5px);
    }
}

.success-animation {
    animation: fadeInUp 1s ease-out;
}

@keyframes fadeInUp {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.impact-item {
    padding: 1rem 0.5rem;
    border-radius: 0.5rem;
    transition: all 0.3s ease;
}

.impact-item:hover {
    background-color: #f8f9fa;
    transform: translateY(-2px);
}

.timeline {
    text-align: left;
    position: relative;
    padding-left: 2rem;
}

.timeline-item {
    position: relative;
    margin-bottom: 1.5rem;
    display: flex;
    align-items: flex-start;
    gap: 1rem;
}

.timeline-item:last-child {
    margin-bottom: 0;
}

.timeline-icon {
    width: 32px;
    height: 32px;
    border-radius: 50%;
    background: white;
    border: 2px solid #e9ecef;
    display: flex;
    align-items: center;
    justify-content: center;
    flex-shrink: 0;
    position: relative;
    z-index: 1;
}

.timeline-item:not(:last-child) .timeline-icon::after {
    content: '';
    position: absolute;
    top: 32px;
    left: 50%;
    transform: translateX(-50%);
    width: 2px;
    height: 24px;
    background: #e9ecef;
    z-index: -1;
}

.timeline-content {
    flex: 1;
    padding-top: 0.25rem;
}

.points-earned {
    animation: slideInRight 1s ease-out 0.5s both;
}

@keyframes slideInRight {
    from {
        opacity: 0;
        transform: translateX(30px);
    }
    to {
        opacity: 1;
        transform: translateX(0);
    }
}

.next-steps {
    animation: fadeIn 1s ease-out 1s both;
}

@keyframes fadeIn {
    from {
        opacity: 0;
    }
    to {
        opacity: 1;
    }
}

@media (max-width: 767px) {
    .timeline {
        padding-left: 1.5rem;
    }
    
    .timeline-icon {
        width: 28px;
        height: 28px;
    }
    
    .timeline-item:not(:last-child) .timeline-icon::after {
        top: 28px;
        height: 20px;
    }
    
    .impact-item {
        padding: 0.75rem 0.25rem;
    }
    
    .impact-item i {
        font-size: 1.5rem !important;
    }
}
</style>
{% endblock %}

{% block extra_js %}
<script>
// Share functions
function shareOnFacebook() {
    const url = encodeURIComponent(window.location.origin);
    const text = encodeURIComponent('I just made a donation to help patients access essential medical supplies through Ytili! Join me in making a difference. #YtiliDonation #HealthcareForAll');
    window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank', 'width=600,height=400');
}

function shareOnTwitter() {
    const url = encodeURIComponent(window.location.origin);
    const text = encodeURIComponent('I just made a donation through @Ytili to help patients access essential medical supplies! Join me in making a difference. #YtiliDonation #HealthcareForAll');
    window.open(`https://twitter.com/intent/tweet?url=${url}&text=${text}`, '_blank', 'width=600,height=400');
}

function shareOnWhatsApp() {
    const url = encodeURIComponent(window.location.origin);
    const text = encodeURIComponent('I just made a donation to help patients access essential medical supplies through Ytili! Check it out and join me in making a difference: ' + window.location.origin);
    window.open(`https://wa.me/?text=${text}`, '_blank');
}

function copyLink() {
    const url = window.location.origin;
    
    if (navigator.clipboard) {
        navigator.clipboard.writeText(url).then(() => {
            showCopyFeedback();
        });
    } else {
        // Fallback for older browsers
        const textArea = document.createElement('textarea');
        textArea.value = url;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
        showCopyFeedback();
    }
}

function showCopyFeedback() {
    const button = event.target.closest('button');
    const originalText = button.innerHTML;
    button.innerHTML = '<i class="fas fa-check"></i> Copied!';
    button.classList.add('btn-success');
    button.classList.remove('btn-outline-secondary');
    
    setTimeout(() => {
        button.innerHTML = originalText;
        button.classList.remove('btn-success');
        button.classList.add('btn-outline-secondary');
    }, 2000);
}

// Auto-redirect after 30 seconds (optional)
setTimeout(() => {
    if (confirm('Would you like to view your donation dashboard?')) {
        window.location.href = '{{ url_for("transparency.dashboard") }}';
    }
}, 30000);
</script>
{% endblock %}
